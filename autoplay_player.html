<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  </head>
<body>
  <!-- Interaction overlay for browsers that require user gesture -->
  <div class="overlay" id="overlay">
    <div class="overlay-content">
    </div>
  </div>

  <div class="card" role="main" aria-labelledby="title">
    <div class="controls" aria-hidden="false">
    </div>

<audio id="player" preload="auto" playsinline loop autoplay>
  <source src="white noise.mp3" type="audio/mpeg">
</audio>
  <script>
    (function(){
      const player = document.getElementById('player');
      const stopBtn = document.getElementById('stopBtn');
      const status = document.getElementById('status');
      const note = document.getElementById('note');
      const overlay = document.getElementById('overlay');
      let isPlaying = false;

      // Prevent any pause attempts
      player.addEventListener('pause', function(e){
        if (isPlaying) {
          e.preventDefault();
          player.play().catch(err => console.log('Resume failed:', err));
        }
      });

      // Auto-restart if somehow stopped
      player.addEventListener('ended', function(){
        if (isPlaying) {
          player.currentTime = 0;
          player.play().catch(err => console.log('Restart failed:', err));
        }
      });

      // Function to start playback
      function startPlayback(){
        player.playsInline = true;
        player.loop = true;
        player.muted = false;
        const playPromise = player.play();
        if (playPromise !== undefined) {
          playPromise.then(()=> {
            isPlaying = true;
            overlay.style.display = 'none';
            status.textContent = 'ðŸ”Š Playing continuously';
            note.textContent = 'Audio is looping. Press Stop to end playback.';
          }).catch((err)=> {
            console.log('Autoplay blocked, showing overlay:', err && err.message ? err.message : err);
            // Overlay already visible, waiting for user interaction
          });
        }
      }

      // Try immediate autoplay and fullscreen
      requestFullscreen();
      startPlayback();

      // Also try when page becomes visible
      document.addEventListener('visibilitychange', function(){
        if (document.visibilityState === 'visible' && !isPlaying) {
          startPlayback();
        }
      });

      // Request fullscreen
      function requestFullscreen(){
        const elem = document.documentElement;
        if (elem.requestFullscreen) {
          elem.requestFullscreen().catch(err => console.log('Fullscreen failed:', err));
        } else if (elem.webkitRequestFullscreen) {
          elem.webkitRequestFullscreen();
        } else if (elem.mozRequestFullScreen) {
          elem.mozRequestFullScreen();
        } else if (elem.msRequestFullscreen) {
          elem.msRequestFullscreen();
        }
      }

      // Handle user interaction with overlay
      overlay.addEventListener('click', function(){
        requestFullscreen();
        startPlayback();
      });

      // Also try on any user interaction with the document
      function handleFirstInteraction(){
        if (!isPlaying) {
          requestFullscreen();
          startPlayback();
        }
      }
      
      document.addEventListener('click', handleFirstInteraction, { once: true });
      document.addEventListener('touchstart', handleFirstInteraction, { once: true });
      document.addEventListener('keydown', handleFirstInteraction, { once: true });

      // Stop button - the only way to stop
      stopBtn.addEventListener('click', function(){
        isPlaying = false;
        player.pause();
        player.currentTime = 0;
        status.textContent = 'Stopped';
        note.textContent = 'Refresh page to play again.';
        stopBtn.disabled = true;
        stopBtn.style.opacity = '0.5';
      });

      // Block keyboard controls that might pause
      document.addEventListener('keydown', function(e){
        if (isPlaying && (e.key === ' ' || e.key === 'k')) {
          e.preventDefault();
        }
      });

      // Prevent media key pause events
      if ('mediaSession' in navigator) {
        navigator.mediaSession.setActionHandler('pause', () => {
          // Do nothing - block pause
        });
        navigator.mediaSession.setActionHandler('play', () => {
          if (!isPlaying) {
            startPlayback();
          }
        });
      }
    })();
  </script>
</body>
</html>